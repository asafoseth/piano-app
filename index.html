<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Force desktop view on iOS Safari - Enhanced for better zoom -->
    <meta name="viewport" content="width=1024, initial-scale=0.5, minimum-scale=0.25, maximum-scale=3.0, user-scalable=yes, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>UA Piano (Demo)</title>
    <!-- Style CSS -->
    <link rel="stylesheet" href="css/style.css">
    <script>
      // Enhanced iOS touch zoom support - Better pinch-to-zoom experience
      window.addEventListener('DOMContentLoaded', function() {
        // Detect iOS devices specifically
        const isIOSDevice = /iPad|iPhone|iPod/.test(navigator.userAgent);
        const isSafari = /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);
        
        if (isIOSDevice && isSafari) {
          // Use CSS-based scaling that works better with touch zoom
          const style = document.createElement('style');
          style.textContent = `
            @media screen and (max-device-width: 768px) {
              html {
                zoom: 0.5;
              }
              
              /* Improve touch responsiveness */
              * {
                touch-action: manipulation;
              }
              
              /* Allow pinch zoom on piano area */
              .piano-container {
                touch-action: pinch-zoom;
              }
              
              /* Prevent double-tap zoom except on piano */
              body {
                touch-action: pan-x pan-y;
              }
            }
          `;
          document.head.appendChild(style);
          
          // Add visual zoom controls for better UX
          const createZoomControls = () => {
            const zoomControls = document.createElement('div');
            zoomControls.style.cssText = `
              position: fixed;
              top: 10px;
              left: 10px;
              z-index: 1000;
              display: flex;
              gap: 10px;
              background: rgba(0,0,0,0.7);
              padding: 5px;
              border-radius: 5px;
            `;
            
            const zoomInBtn = document.createElement('button');
            zoomInBtn.textContent = '+';
            zoomInBtn.style.cssText = `
              width: 40px;
              height: 40px;
              font-size: 20px;
              background: #ffe600;
              border: none;
              border-radius: 3px;
              cursor: pointer;
            `;
            
            const zoomOutBtn = document.createElement('button');
            zoomOutBtn.textContent = 'âˆ’';
            zoomOutBtn.style.cssText = `
              width: 40px;
              height: 40px;
              font-size: 20px;
              background: #ffe600;
              border: none;
              border-radius: 3px;
              cursor: pointer;
            `;
            
            let currentZoom = 0.5;
            
            zoomInBtn.addEventListener('click', () => {
              currentZoom = Math.min(currentZoom + 0.1, 2.0);
              document.documentElement.style.zoom = currentZoom;
            });
            
            zoomOutBtn.addEventListener('click', () => {
              currentZoom = Math.max(currentZoom - 0.1, 0.3);
              document.documentElement.style.zoom = currentZoom;
            });
            
            zoomControls.appendChild(zoomOutBtn);
            zoomControls.appendChild(zoomInBtn);
            document.body.appendChild(zoomControls);
          };
          
          // Add zoom controls after a short delay
          setTimeout(createZoomControls, 1000);
        }
      });
    </script>
    </script>
  </head>
  <body>
    <header>
      <nav>
        <div class="nav-group" style="display: flex; align-items: center; gap: 10px;">
          <a href="#" class="nav-button">Home</a>
          <a href="#" class="nav-button">About</a>
          <span id="user-info" style="display:none; color:#fff; font-weight:500; margin-left:10px;"></span>
          <button id="show-login-modal">Login</button>
          <!-- If you have a logout button, add it here and toggle with JS -->
          <!-- <button id="logout-btn" style="display:none;">Logout</button> -->
        </div>
        <button id="save-tab-btn" style="display:none;">Save TAB</button>
        <button id="import-tab-btn" style="display:none;">Import TAB</button>
      </nav>
    </header>
    <div class="main">
        <div class="container">

        <h1>uncle Ali Piano</h1>

        <!-- Container for the two contro-->
        <div class="controls-row">
            <!-- Left Column: TAB Feature -->
            <div class="tab-column">
                <!-- TAB Feature Section -->
                <div class="tab-feature-container">
                    <h2>TAB</h2>
                    <div class="tab-controls">
                        <!-- Find the Beat ON/OFF button, assumed to be: -->
<button id="tab-feature-toggle">Beat: OFF</button>
<!-- Place the undo/redo buttons just before or after it: -->
<div style="display:inline-block; vertical-align:middle; margin-right:8px;">
  <button id="undo-btn" title="Undo" style="font-size:1.3em; background: #ffe600; border: none; cursor: pointer; vertical-align: middle; border-radius: 50%; width: 2.2em; height: 2.2em; display: inline-flex; align-items: center; justify-content: center; box-shadow: 0 1px 4px #ccc;">
    &#8630;
  </button>
  <button id="redo-btn" title="Redo" style="font-size:1.3em; background: #ffe600; border: none; cursor: pointer; vertical-align: middle; border-radius: 50%; width: 2.2em; height: 2.2em; display: inline-flex; align-items: center; justify-content: center; box-shadow: 0 1px 4px #ccc;">
    &#8631;
  </button>
</div>
                        <div class="beat-track-select-container">
                            <label for="beat-track-select">Beat Track:</label>
                            <select id="beat-track-select">
                                <option value="track1">Track 1</option>
                                <option value="track2">Track 2</option>
                                <option value="track3">Track 3</option>
                            </select>
                        </div>
                    </div>
                    <!-- TAB Note Inputs -->
                    <div class="tab-note-inputs">
                        <!-- Generate 16 fields -->
                        <!-- You can use a loop in JS, but for static HTML, just copy 16 times -->
                        <div class="tab-note-entry" data-entry-index="0">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 1 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="1">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 2 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="2">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 3 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="3">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 4 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="4">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 5 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="5">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 6 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="6">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 7 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="7">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 8 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="8">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 9 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="9">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 10 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="10">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 11 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="11">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 12 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="12">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 13 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="13">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 14 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="14">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 15 ID">
                            </div>
                        </div>
                        <div class="tab-note-entry" data-entry-index="15">
                            <div class="tab-input-wrapper">
                                <input type="text" class="tab-note-input" data-original-input="true" placeholder="Note 16 ID">
                            </div>
                        </div>
                    </div>
                    <div class="tab-action-buttons">
                        <button id="play-tab-btn">Play TAB</button>
                        <button id="delete-tab-btn" style="background:#d32f2f; color:#fff;">Delete</button>
                        <button id="reset-tab-btn" style="background:#ffe600; color:#222;">Reset TAB</button>
                    </div>
                </div>
            </div>

            <!-- Right Column: Other Controls -->
            <div class="other-controls-column" style="margin-top:180px;">
                <!-- Transpose Controls -->
                <div class="transpose-container">
                    <label for="transpose-value">Transpose:</label>
                    <button class="transpose-btn" id="transpose-up">+</button>
                    <span id="transpose-value">0</span>
                    <button class="transpose-btn" id="transpose-down">-</button>
                </div>

                <!-- Container for the Chord Mode toggle button and key switcher buttons -->
                <div class="controls-container">
                    <div class="key-switcher-container">
                        <label for="key-switcher-select">Select Key (UAT ruler):</label>
                        <select id="key-switcher-select">
                            <option value="C">C</option><option value="C#">C#</option><option value="D">D</option><option value="D#">D#</option><option value="E">E</option><option value="F">F</option><option value="F#">F#</option><option value="G">G</option><option value="G#">G#</option><option value="A">A</option><option value="A#">A#</option><option value="B">B</option>
                        </select>
                    </div>
                    <!-- Sync Key Finder and Volume Controls -->
                    <div class="sync-controls-container">
                        <label for="syncKeyFinderToggle">
                            <input type="checkbox" id="syncKeyFinderToggle"> Enable Sing Key
                        </label>
                    </div>
                    <div style="display:flex; justify-content:center; margin-top:10px;">
                        <button id="chord-mode-toggle">Chord Mode: OFF</button>
                    </div>
                </div>
            </div>

        </div>

        <!-- TAB Feature Section -->
        <!-- Container for Piano Keys -->
        <h2 class="piano-title">uncle Ali Piano</h2>
        <div class="piano-container" id="keyboard-container"></div>
    </div>
  
    <div id="login-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:100;">
      <div style="background:#fff; margin:10vh auto; padding:2em; border-radius:8px; width:320px; position:relative;">
        <h2>Login / Signup</h2>
        <button id="google-login-btn" style="width:100%; margin-bottom:10px;">Login with Google</button>
        <input type="email" id="email-input" placeholder="Email" style="width:100%; margin-bottom:8px;">
        <input type="password" id="password-input" placeholder="Password" style="width:100%; margin-bottom:8px;">
        <button id="email-login-btn" style="width:100%; margin-bottom:10px;">Login / Signup with Email</button>
        <button id="close-login-modal" title="Close" style="position:absolute; top:8px; right:8px;">&times;</button>
        <div id="login-error" style="color:red; margin-top:8px;"></div>
      </div>
    </div>
    <button id="show-login-modal" style="position:fixed; top:10px; right:10px; z-index:101;">Login</button>

    <!-- Save TAB Modal -->
<div id="save-tab-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:1001;">
  <div style="background:#fff; margin:10vh auto; padding:2em; border-radius:8px; width:320px; position:relative;">
    <h2 style="font-size:1.2em; color:#222;">Save TAB Data</h2>
    <input type="text" id="tab-save-name" placeholder="Enter a name..." style="width:100%; margin-bottom:12px;">
    <button id="confirm-save-tab" style="width:100%;">Save</button>
    <button id="close-save-tab-modal" style="position:absolute; top:12px; left:12px; background:#f44336; color:#fff; border-radius:50%; width:32px; height:32px; border:none;">&times;</button>
    <div id="save-tab-error" style="color:red; margin-top:8px;"></div>
  </div>
</div>

<!-- Import TAB Modal -->
<div id="import-tab-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:1001;">
  <div style="background:#fff; margin:10vh auto; padding:2em; border-radius:8px; width:340px; position:relative;">
    <h2 style="font-size:1.2em; color:#222;">Import TAB Data</h2>
    <ul id="tab-import-list" style="list-style:none; padding:0; margin-bottom:12px;"></ul>
    <button id="close-import-tab-modal" style="position:absolute; top:12px; left:12px; background:#f44336; color:#fff; border-radius:50%; width:32px; height:32px; border:none;">&times;</button>
    <div id="import-tab-error" style="color:red; margin-top:8px;"></div>
  </div>
</div>

    <script type="module" src="/js/main.js"></script>
  </body>
</html>
